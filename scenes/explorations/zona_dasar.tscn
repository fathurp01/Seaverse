[gd_scene load_steps=30 format=3 uid="uid://bykgdjv7n5m4c"]

[ext_resource type="Texture2D" uid="uid://cm2jp15dnhplc" path="res://assets/Zona-Dasar/Bg_dua.png" id="2_vsg5l"]
[ext_resource type="Texture2D" uid="uid://qe854mc1641r" path="res://assets/seaverse_icon.png" id="3_8sav5"]
[ext_resource type="Script" uid="uid://bn0813afw7vfm" path="res://scenes/explorations/submarine_dasar.gd" id="4_yee8m"]
[ext_resource type="Texture2D" uid="uid://b14ah7pkbj7ay" path="res://assets/Zona-Dasar/kapal.png" id="5_au1i2"]
[ext_resource type="PackedScene" uid="uid://beenqdl3712x7" path="res://scenes/explorations/fish.tscn" id="6_16ldu"]
[ext_resource type="Texture2D" uid="uid://c23da1qtin3o3" path="res://assets/Zona-Dasar/Blob Fish.png" id="7_16ldu"]
[ext_resource type="Texture2D" uid="uid://3f7m2ty4xbwj" path="res://assets/Zona-Dasar/Tripod Fish.png" id="8_vsg5l"]
[ext_resource type="AudioStream" uid="uid://dpenpx3cnkpo0" path="res://assets/sounds/popup_info.wav" id="8_yr86c"]
[ext_resource type="Texture2D" uid="uid://hu2wxkkbsgsl" path="res://assets/Zona-Dasar/Deep Sea Crab.png" id="9_yr86c"]
[ext_resource type="Texture2D" uid="uid://d26o2yghneh8d" path="res://assets/Zona-Dasar/Sixgil Shark.png" id="11_gytvp"]
[ext_resource type="Texture2D" uid="uid://7nasdebdwxnf" path="res://assets/Zona-Dasar/Snipe Ell.png" id="11_pt4q5"]
[ext_resource type="Texture2D" uid="uid://b7xqthbxk5fbq" path="res://assets/Zona-Dasar/Rattail Fish.png" id="12_arqsu"]
[ext_resource type="Texture2D" uid="uid://b10ae61mcacln" path="res://assets/Zona-Dasar/Medusa Jellyfish.png" id="13_pt4q5"]
[ext_resource type="Texture2D" uid="uid://0txfhngbbytl" path="res://assets/Zona-Dasar/Dumbo Octopus.png" id="14_16ldu"]
[ext_resource type="Texture2D" uid="uid://budfbyvvdsoky" path="res://assets/Zona-Dasar/Giant Amphipod.png" id="15_vsg5l"]
[ext_resource type="Texture2D" uid="uid://cll5aqnxxnwvw" path="res://assets/Zona-Dasar/Snailfish.png" id="16_16ldu"]
[ext_resource type="PackedScene" uid="uid://ctw0rumo3pl5p" path="res://scenes/explorations/whirlpool_3.tscn" id="18_yr86c"]
[ext_resource type="Script" uid="uid://iyxajykkharx" path="res://scenes/explorations/ui_tutorial.gd" id="19_arqsu"]
[ext_resource type="AudioStream" uid="uid://ciw0qjqfi66gh" path="res://assets/sounds/Exploration_Music_Dasar.mp3" id="19_gytvp"]

[sub_resource type="GDScript" id="GDScript_yee8m"]
script/source = "extends Camera2D

var submarine = null
var locked_x = 0.0
var camera_offset_y = 0.0  # Offset untuk center vertikal

# Limit kamera atas dan bawah (dalam pixel) - bisa diatur sesuai kebutuhan
var camera_limit_top = 370.0    # Batas atas kamera
var camera_limit_bottom = 2875.0  # Batas bawah kamera

func _ready():
	# Set camera enabled & current
	enabled = true
	make_current()
	
	# Cari submarine dulu
	await get_tree().process_frame
	submarine = get_tree().get_first_node_in_group(\"player\")
	
	if submarine:
		# Lock X ke posisi submarine
		locked_x = submarine.global_position.x
		
		# Set offset Y agar submarine di tengah layar
		# Gunakan viewport height / 2 sebagai offset
		var viewport_height = get_viewport_rect().size.y
		camera_offset_y = 0  # Atau bisa diatur sesuai kebutuhan
		
		# Set posisi awal kamera
		global_position = Vector2(locked_x, submarine.global_position.y + camera_offset_y)
		
		print(\"‚úÖ Camera locked to submarine X:\", locked_x)
		print(\"   Camera limit top:\", camera_limit_top)
		print(\"   Camera limit bottom:\", camera_limit_bottom)
		print(\"   Viewport height:\", viewport_height)
	else:
		print(\"‚ùå ERROR: Submarine not found!\")

func _process(delta):
	if submarine:
		# Offset untuk posisi kamera
		var offset_x = 650   # Geser kanan (+) atau kiri (-)
		var offset_y = 400 # Geser atas (-) atau bawah (+)
		
		# Hitung posisi target kamera
		var target_y = submarine.global_position.y + offset_y
		
		# Batasi posisi Y kamera agar tidak melewati limit atas dan bawah
		target_y = clamp(target_y, camera_limit_top, camera_limit_bottom)
		
		# Lock X dengan offset, follow Y dengan offset dan limit
		global_position = Vector2(locked_x + offset_x, target_y)
"

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_16ldu"]
particle_flag_disable_z = true
emission_shape_offset = Vector3(0, -1, 0)
direction = Vector3(1, -1, 0)
spread = 20.0
initial_velocity_min = 30.0
initial_velocity_max = 60.0
gravity = Vector3(0, -80, 0)
scale_min = 0.5

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ot5n2"]
size = Vector2(277, 173.5)

[sub_resource type="Animation" id="Animation_yr86c"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(651, 360)]
}

[sub_resource type="Animation" id="Animation_vsg5l"]
resource_name = "idle_float"
length = 2.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1, 2),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector2(651, 360), Vector2(651, 350), Vector2(651, 360)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_gytvp"]
_data = {
&"RESET": SubResource("Animation_yr86c"),
&"idle_float": SubResource("Animation_vsg5l")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_fw6x3"]
size = Vector2(1296, 114)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_yee8m"]
size = Vector2(1286, 10)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_au1i2"]
size = Vector2(4.5, 3233)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_gww0r"]
size = Vector2(13, 3248)

[node name="ZonaDasar" type="Control"]
clip_contents = true
layout_mode = 3
anchors_preset = 0
offset_left = -651.0
offset_top = 3.0
offset_right = 651.0
offset_bottom = 3271.0

[node name="Background" type="Node2D" parent="."]

[node name="Sprite2D" type="Sprite2D" parent="Background"]
position = Vector2(650.99994, 859)
scale = Vector2(1.2597655, 1.1119792)
texture = ExtResource("2_vsg5l")

[node name="Sprite2D2" type="Sprite2D" parent="Background"]
position = Vector2(646.62506, 2472.75)
scale = Vector2(1.2526854, 0.991862)
texture = ExtResource("2_vsg5l")

[node name="SubCam" type="Camera2D" parent="."]
position = Vector2(648, 553)
position_smoothing_enabled = true
drag_left_margin = 0.0
drag_top_margin = 0.0
drag_right_margin = 0.0
drag_bottom_margin = 0.0
script = SubResource("GDScript_yee8m")

[node name="Submarine_dasar" type="CharacterBody2D" parent="."]
script = ExtResource("4_yee8m")

[node name="Sprite2D" type="Sprite2D" parent="Submarine_dasar"]
position = Vector2(651, 360)
scale = Vector2(0.626, 0.66499996)
texture = ExtResource("5_au1i2")

[node name="Bubbles" type="GPUParticles2D" parent="Submarine_dasar/Sprite2D"]
z_index = 10
position = Vector2(-4.183, 32.527)
scale = Vector2(2.1, 2.1)
amount = 20
lifetime = 1.5
randomness = 0.3
process_material = SubResource("ParticleProcessMaterial_16ldu")

[node name="DepthLabel_dasar" type="Label" parent="Submarine_dasar"]
offset_left = 623.0
offset_top = 445.0
offset_right = 679.0
offset_bottom = 468.0
text = "1000 M"

[node name="CollisionShape2D" type="CollisionShape2D" parent="Submarine_dasar"]
position = Vector2(653, 350.75)
shape = SubResource("RectangleShape2D_ot5n2")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Submarine_dasar"]
libraries = {
&"": SubResource("AnimationLibrary_gytvp")
}

[node name="Boundaries" type="StaticBody2D" parent="."]

[node name="Batas_atas" type="CollisionShape2D" parent="Boundaries"]
position = Vector2(647, 48)
shape = SubResource("RectangleShape2D_fw6x3")

[node name="Batas_bawah" type="CollisionShape2D" parent="Boundaries"]
position = Vector2(649, 3233)
shape = SubResource("RectangleShape2D_yee8m")

[node name="Batas_kanan" type="CollisionShape2D" parent="Boundaries"]
position = Vector2(1291.75, 1617.5)
shape = SubResource("RectangleShape2D_au1i2")

[node name="Batas_kiri" type="CollisionShape2D" parent="Boundaries"]
position = Vector2(-1.5, 1614)
shape = SubResource("RectangleShape2D_gww0r")

[node name="Sprite2D" type="Sprite2D" parent="."]
position = Vector2(196, 75)
scale = Vector2(0.43950617, 0.4496124)
texture = ExtResource("3_8sav5")

[node name="Fish" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(214, 1526)
fish_name = "Ikan blob"
fish_description = "Ikan blob atau Blobfish hidup di kedalaman sekitar 600‚Äì1.200 meter, tubuhnya lunak dan gelatinous, dengan daging berdaya apung tinggi yang membuatnya ‚Äúmengambang‚Äù di dekat dasar laut tanpa banyak buang energi untuk berenang."
fish_fact = "Fakta seru Setelah diangkat ke permukaan (dekompresi), tubuhnya berubah drastis ‚Äî kulit dan daging mengembang dan melempem, sehingga penampilan ‚Äújelek‚Äù yang sering viral sebenarnya akibat perubahan tekanan, bukan kondisi alami di laut dalam."
fish_sprite = ExtResource("7_16ldu")
fish_icon = ExtResource("7_16ldu")
popup_sound = ExtResource("8_yr86c")

[node name="Fish2" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(787, 1549)
fish_name = "Ikan tripod"
fish_description = "Ikan tripod atau Tripod fish hidup di dataran laut dalam (batial‚Äìabysal), sering di kedalaman 3.000‚Äì4.800 meter; mereka punya sirip panjang yang digunakan seperti ‚Äúkaki‚Äù untuk berdiri di dasar laut dan menunggu makanan lewat."
fish_fact = "Fakta seru Alih-alih berenang bebas, mereka ‚Äúberdiri‚Äù di dasar laut dengan sirip ‚Äî strategi hemat energi ‚Äî dan menangkap makanan yang lewat dengan gerakan minimal. Adaptasi ini memungkinkan hidup di habitat dengan makanan sangat jarang dan kondisi ekstrem."
fish_sprite = ExtResource("8_vsg5l")
fish_icon = ExtResource("8_vsg5l")
popup_sound = ExtResource("8_yr86c")

[node name="Fish3" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(975, 1178)
fish_name = "Kepiting laut dalam"
fish_description = "Kepiting laut dalam atau Deep-sea crab adalah kepiting yang hidup di dasar laut atau zona laut dalam ‚Äî banyak spesies tinggal di celah‚Äìcelah dasar laut, dataran luas atau gunung laut (seamount), beradaptasi terhadap tekanan tinggi, suhu rendah, dan minim cahaya."
fish_fact = "Fakta Seru Karena banyak spesies, sifat dan adaptasinya sangat bervariasi ‚Äî ada yang bergerak perlahan di dasar, ada yang bisa menahan tekanan ekstrem; bentuk cangkang dan ukuran kaki disesuaikan untuk berjalan di dasar lunak atau berbatu; mereka sering menjadi bagian penting dari ekosistem laut dalam sebagai detritivora atau scavenger."
fish_sprite = ExtResource("9_yr86c")
fish_icon = ExtResource("9_yr86c")
popup_sound = ExtResource("8_yr86c")

[node name="Fish4" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(950, 787)
fish_name = "Belut snipe"
fish_description = "Belut snipe atau Snipe eel adalah ikan laut dalam yang hidup pada kedalaman 1.000 meter lebih, memiliki tubuh sangat panjang, ramping, dan bergerak seperti pita di zona gelap laut dalam. Rahangnya yang melengkung menyerupai paruh burung membantunya menangkap mangsa kecil seperti krill dan plankton."
fish_fact = "Fakta Seru Meskipun panjangnya bisa mencapai 2 meter, snipe eel sangat ringan dan ekornya berubah menjadi helaian halus saat dewasa. Ia memiliki jumlah ruas tulang belakang yang sangat banyak sehingga dapat membengkok ekstrem. Snipe eel hampir tidak pernah terlihat hidup-hidup karena jarang naik ke permukaan, membuatnya menjadi salah satu makhluk laut dalam paling misterius."
fish_sprite = ExtResource("11_pt4q5")
fish_icon = ExtResource("11_pt4q5")
popup_sound = ExtResource("8_yr86c")

[node name="Fish5" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(116, 691)
fish_name = "Hiu enam insang kerdil"
fish_description = "Hiu enam insang kerdil atau Sixgill shark adalah hiu laut dalam dengan enam insang (bukan lima seperti kebanyakan hiu), hidup di kedalaman mulai sekitar 1.000 meter ke bawah ‚Äî sering berada di tepi lereng kontinen atau laut dalam global."
fish_fact = "Fakta Seru Struktur insang dan tubuhnya memberi adaptasi untuk hidup di air dingin dan tekanan tinggi; karena habitat dalam dan penyebaran global, mereka sulit dipelajari, sehingga banyak informasi mengenai perilaku dan biologi mereka masih terbatas, membuat mereka salah satu predator laut dalam yang paling misterius."
fish_sprite = ExtResource("11_gytvp")
fish_icon = ExtResource("11_gytvp")
popup_sound = ExtResource("8_yr86c")

[node name="Fish6" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(126, 1134)
fish_name = "Ikan grenadier"
fish_description = "Ikan grenadier atau Rattail adalah ikan dasar laut dalam dengan kepala besar dan tubuh mengecil tajam ke ekor, biasanya hidup pada kedalaman 1.000 - 2.000 meter. Mereka bergerak perlahan tetapi efisien, menghemat energi di zona bathyal yang minim makanan. Tubuhnya disesuaikan untuk mendeteksi bau dan getaran kecil dari jarak jauh."
fish_fact = "Fakta seru Indra penciuman rattail sangat tajam, membuatnya mampu menemukan bangkai atau mangsa kecil di dasar laut gelap total. Mereka termasuk ikan laut dalam yang paling banyak ditemukan di dunia. Beberapa spesies dapat hidup dalam suhu hampir mendekati titik beku tanpa kehilangan fungsi tubuh."
fish_sprite = ExtResource("12_arqsu")
fish_icon = ExtResource("12_arqsu")
popup_sound = ExtResource("8_yr86c")

[node name="Fish7" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(282, 1916)
fish_name = "Ubur-ubur medusa laut dalam"
fish_description = "Ubur-ubur medusa laut dalam atau Abyssal medusa adalah ubur-ubur laut dalam yang hidup di zona 3.000‚Äì6.000 meter, dengan tubuh transparan dan tentakel panjang menyerupai pita. Mereka melayang pasif mengikuti arus karena energi di kedalaman sangat terbatas. Bentuknya yang sederhana memungkinkan bertahan di tekanan ekstrem tanpa struktur keras."
fish_fact = "Fakta Seru Banyak spesies abyssal medusa mampu menghasilkan cahaya bioluminesensi untuk menarik mangsa atau membingungkan predator. Mereka sering terlihat seperti ‚Äúlampu hidup‚Äù di kegelapan laut dalam. Kemunculan mereka jarang terekam kamera sehingga sebagian besar spesiesnya masih misterius."
fish_sprite = ExtResource("13_pt4q5")
fish_icon = ExtResource("13_pt4q5")
popup_sound = ExtResource("8_yr86c")

[node name="Fish8" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(194, 2595)
fish_name = "Gurita dumbo"
fish_description = "Gurita dumbo atau Dumbo octopus adalah gurita laut dalam yang ditemukan pada kedalaman 1.000‚Äì7.000 meter. Julukannya berasal dari sirip seperti telinga Dumbo yang digunakan untuk berenang lembut di kegelapan abyssal. Tubuhnya lunak, kecil, dan tidak memiliki kantung tinta karena tidak dibutuhkan di laut dalam."
fish_fact = "Fakta seru Ia adalah gurita terdalam yang pernah ditemukan hidup, bahkan ada yang terekam di >7.000 meter. Dumbo octopus tidak memangsa secara agresif dan hanya menelan mangsa bulat-bulat. Bentuknya yang lucu membuatnya dijuluki ‚Äúmakhluk tersopan di laut dalam."
fish_sprite = ExtResource("14_16ldu")
fish_icon = ExtResource("14_16ldu")
popup_sound = ExtResource("8_yr86c")

[node name="Fish9" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(804, 2214)
fish_name = "Amfipoda raksasa"
fish_description = "Amfipoda raksasa atau Giant amphipod adalah krustasea laut dalam berukuran besar yang hidup di kedalaman 4.000‚Äì7.000 meter. Mereka memiliki tubuh bening dengan antena panjang dan bergerak cepat di dasar laut gelap. Hewan ini memakan detritus dan bangkai yang jatuh dari permukaan laut."
fish_fact = "Fakta seru Meskipun kebanyakan amphipod kecil, spesies ini bisa tumbuh hingga 30 cm‚Äîraksasa untuk kelasnya. Tubuhnya transparan agar tersamarkan di lingkungan tanpa cahaya. Ketahanan mereka terhadap tekanan ekstrem membuatnya menjadi salah satu hewan paling kuat di zona hadal."
fish_sprite = ExtResource("15_vsg5l")
fish_icon = ExtResource("15_vsg5l")
popup_sound = ExtResource("8_yr86c")

[node name="Fish10" parent="." instance=ExtResource("6_16ldu")]
position = Vector2(878, 2737)
fish_name = "Ikan siput hadal"
fish_description = "Ikan siput hadal atau Snailfish hadal hidup antara 6.000‚Äì8.200 meter di palung laut terdalam, termasuk Mariana Trench. Tubuhnya lunak, hampir seperti jelly, tanpa sisik dan tanpa kantung renang. Mereka bergerak perlahan tetapi sangat efisien di tekanan ratusan kali lebih kuat dari permukaan."
fish_fact = "Fakta seru Snailfish adalah ikan terdalam yang pernah direkam hidup‚Äîlebih dalam daripada kapal selam manusia. Enzim dan struktur selnya mencegah tubuhnya hancur di tekanan ekstrem. Meski hidup di kedalaman menakutkan, mereka justru menjadi predator puncak di zona hadal."
fish_sprite = ExtResource("16_16ldu")
fish_icon = ExtResource("16_16ldu")
popup_sound = ExtResource("8_yr86c")

[node name="whirlpool_3" parent="." instance=ExtResource("18_yr86c")]
position = Vector2(649, 3105)
notification_position = 1

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource("19_gytvp")
autoplay = true

[node name="UI" type="CanvasLayer" parent="."]
script = ExtResource("19_arqsu")

[node name="BtnTutorial" type="Button" parent="UI"]
offset_left = 5.0
offset_top = 3.0
offset_right = 35.0
offset_bottom = 34.0
text = "‚ùì"

[node name="TutorialPanel" type="Panel" parent="UI"]
process_mode = 2
offset_right = 437.0
offset_bottom = 224.0

[node name="Label" type="Label" parent="UI/TutorialPanel"]
layout_mode = 0
offset_left = 49.0
offset_top = 3.0
offset_right = 339.0
offset_bottom = 182.0
text = "üéÆ Tutorial Bermain:
‚Üê : Gerak kiri
‚Üí : Gerak kanan
‚Üë : Naik
‚Üì : Turun
- Semakin dalam, kapal makin lambat
- Dekati ikan untuk melihat info
- Temukan 10 ikan untuk membuka pusaran air"

[node name="BtnTutup" type="Button" parent="UI/TutorialPanel"]
process_mode = 2
layout_mode = 0
offset_left = 397.0
offset_top = 1.0
offset_right = 437.0
offset_bottom = 41.0
text = "X"
